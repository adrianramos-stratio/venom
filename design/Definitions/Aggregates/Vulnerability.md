## 🧠 Entity Definition: `Vulnerability`

### 🏷 Entity Name

> `Vulnerability` (Authoritative external description of a known security issue)

### 🎯 Purpose

> Represent a public vulnerability, identified by a CVE or similar ID, as provided by an external vulnerability feed (e.g., Grype, NVD). Used as the external reference for evaluating the exposure and impact on internal components.

### 🧱 Entity Identity

> `VulnerabilityId = cve_id`

---

## 📥 Ingested Data Fields

|Field|Description|
|---|---|
|`cve_id`|Unique identifier of the vulnerability (e.g., CVE-2024-1234)|
|`title`|Short human-readable description|
|`description`|Full text description of the vulnerability|
|`cvss_v3`|CVSS v3 base vector and score|
|`cvss_v4`|CVSS v4 base vector and score (if available)|
|`published_at`|Date the vulnerability was disclosed|
|`last_updated`|Timestamp of the most recent update|

---

## 📤 Emitted Events

|Event|Description|
|---|---|
|`VulnerabilityRegistered`|A new vulnerability has been ingested|
|`VulnerabilityUpdated`|An existing vulnerability has been updated|

---

## ⚖️ Invariants Maintained

- The `cve_id` must be globally unique and valid
- All CVSS vectors must be syntactically correct (if present)
- No modification of semantics beyond what is ingested from upstream feeds

---

## 🧭 Contextual Boundaries

- `Vulnerability` is **not an aggregate**. It is an **external entity**, cached from an authoritative source.
- It resides within the **Vulnerability Catalog Context**.
- It is immutable from the domain’s perspective and only evolves by ingesting new versions from external feeds.
    

---

## 🔗 Consuming Contexts

- **BindingContext**: uses the CVSS base data to evaluate impact
- **BindingOrchestratorActor**: reacts to updates to trigger reclassification logic

---

## 💡 Additional Notes

- Vulnerabilities are synchronized in bulk or incrementally via polling, webhook, or subscription
- No business logic or classification occurs inside this entity
- All decisions and actions based on vulnerabilities happen in downstream contexts

---